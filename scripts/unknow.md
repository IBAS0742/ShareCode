## 那里不对劲？

#### q1: 将日期字符串(yyyy-mm-dd)转为时间戳，然后将时间戳转为日期字符串(yyyy-mm-dd)

```javascript
var dchange = (function () {
    let d = new Date();
    d.setHours(0);
    d.setMinutes(0);
    d.setSeconds(0);
    d.setMilliseconds(0);
    // ymd = 1999-11-10
    let t2 = a => {
        a = a + '';
        return '00'.substring(a.length) + a;
    }
    return {
        ymd2ts: ymd => { // 将 yyyy-mm-dd 转为时间戳
            ymd = ymd.split('-').map(_=>+_);
            d.setFullYear(ymd[0]);
            d.setMonth(ymd[1] - 1);
            d.setDate(ymd[2]);
            return d.getTime();
        },
        ts2ymd: ts => { // 将 时间戳 转为 yyyy-mm-dd
            d.setTime(ts);
            return `${d.getFullYear()}-${t2(d.getMonth() + 1)}-${t2(d.getDate())}`
        }
    };
})();
// let s = '2000-11-01';
// console.log(dchange.ts2ymd(dchange.ymd2ts(s)) === s);
a = [
    "1999-11-10","1999-11-11","1999-11-12","1999-11-15","1999-11-16","1999-11-17","1999-11-18",
    "1999-11-19","1999-11-22","1999-11-23","1999-11-24","1999-11-25","1999-11-26","1999-11-29",
    "1999-11-30","1999-12-01","1999-12-02","1999-12-03","1999-12-06","1999-12-07","1999-12-08",
    "1999-12-09","1999-12-10","1999-12-13","1999-12-14","1999-12-15","1999-12-16","1999-12-17",
    "1999-12-21","1999-12-22","1999-12-23","1999-12-24","1999-12-27","1999-12-28","1999-12-29",
    "1999-12-30","2000-01-04","2000-01-05","2000-01-06","2000-01-07","2000-01-10","2000-01-11",
    "2000-01-12","2000-01-13","2000-01-14","2000-01-17","2000-01-18","2000-01-19","2000-01-20",
    "2000-01-21","2000-01-24","2000-01-25","2000-01-26","2000-01-27","2000-01-28","2000-02-14",
    "2000-02-15","2000-02-16","2000-02-17","2000-02-18","2000-02-21","2000-02-22","2000-02-23",
    "2000-02-24","2000-02-25","2000-02-28","2000-02-29","2000-03-01","2000-03-02","2000-03-03",
    "2000-03-06","2000-03-07","2000-03-08","2000-03-09","2000-03-10","2000-03-13","2000-03-14",
    "2000-03-15","2000-03-16","2000-03-17","2000-03-20","2000-03-21","2000-03-22","2000-03-23",
    "2000-03-24","2000-03-27","2000-03-28","2000-03-29","2000-03-30","2000-03-31","2000-04-03",
    "2000-04-04","2000-04-05","2000-04-06","2000-04-07","2000-04-10","2000-04-11","2000-04-12",
    "2000-04-13","2000-04-14","2000-04-17","2000-04-18","2000-04-19","2000-04-20","2000-04-21",
    "2000-04-24","2000-04-25","2000-04-26","2000-04-27","2000-04-28","2000-05-09","2000-05-10",
    "2000-05-11","2000-05-12","2000-05-15","2000-05-16","2000-05-17","2000-05-18","2000-05-19",
    "2000-05-22","2000-05-23","2000-05-24","2000-05-25","2000-05-26","2000-05-29","2000-05-30",
    "2000-05-31","2000-06-01","2000-06-02","2000-06-05","2000-06-06","2000-06-07","2000-06-08",
    "2000-06-09","2000-06-12","2000-06-13","2000-06-14","2000-06-15","2000-06-16","2000-06-19",
    "2000-06-20","2000-06-21","2000-06-22","2000-06-23","2000-06-26","2000-06-27","2000-06-28",
    "2000-06-29","2000-06-30","2000-07-03","2000-07-04","2000-07-05","2000-07-06","2000-07-07",
    "2000-07-10","2000-07-11","2000-07-12","2000-07-13","2000-07-14","2000-07-17","2000-07-18",
    "2000-07-19","2000-07-20","2000-07-21","2000-07-24","2000-07-25","2000-07-26","2000-07-27",
    "2000-07-28","2000-07-31","2000-08-01","2000-08-02","2000-08-03","2000-08-04","2000-08-07",
    "2000-08-08","2000-08-09","2000-08-10","2000-08-11","2000-08-14","2000-08-15","2000-08-16",
    "2000-08-17","2000-08-18","2000-08-21","2000-08-22","2000-08-23","2000-08-24","2000-08-25",
    "2000-08-28","2000-08-29","2000-08-30","2000-08-31","2000-09-01","2000-09-04","2000-09-05",
    "2000-09-06","2000-09-07","2000-09-08","2000-09-11","2000-09-12","2000-09-13","2000-09-14",
    "2000-09-15","2000-09-18","2000-09-19","2000-09-20","2000-09-21","2000-09-22","2000-09-25",
    "2000-09-26","2000-09-27","2000-09-28","2000-09-29","2000-10-09","2000-10-10","2000-10-11",
    "2000-10-12","2000-10-13","2000-10-16","2000-10-17","2000-10-18","2000-10-19","2000-10-20",
    "2000-10-23","2000-10-24","2000-10-25","2000-10-26","2000-10-27","2000-10-30","2000-10-31","2000-11-01"];
a = a.filter(s => {
    let c = dchange.ts2ymd(dchange.ymd2ts(s));
    if (c !== s) {
        console.log(`${s}\t${c}`)
        return true;
    } else {
        return false;
    }
});
console.log("check again")
a.forEach(i => {
    console.log(`${i}\t${dchange.ts2ymd(dchange.ymd2ts(i))}`);
});
```

- 执行结果

```text
2000-04-03      2000-05-03
2000-06-01      2000-07-01
2000-09-01      2000-10-01
2000-11-01      2000-12-01
check again
2000-04-03      2000-04-03
2000-06-01      2000-06-01
2000-09-01      2000-09-01
2000-11-01      2000-11-01
```